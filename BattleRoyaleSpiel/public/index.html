<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Battle Royale JS</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Arial', sans-serif; user-select: none; touch-action: none; -webkit-touch-callout: none; }
        
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        .interactive { pointer-events: auto; }

        #crosshair {
            position: absolute; top: 50%; left: 50%; width: 4px; height: 4px;
            background: white; border: 2px solid black; border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        #stats-container { position: absolute; bottom: 85px; left: 50%; transform: translateX(-50%); width: 300px; text-align: center; }
        .bar-wrap { width: 100%; height: 10px; background: #333; border: 1px solid black; margin-top: 2px; }
        #shield-bar { width: 100%; height: 100%; background: #00aaff; transition: width 0.2s; }
        #hp-bar { width: 100%; height: 100%; background: #00ff00; transition: width 0.2s; }

        /* CRITICAL FIX: Z-INDEX 100 (Highest Priority) */
        #inventory {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); 
            display: flex; gap: 5px; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 10px;
            z-index: 100; /* Higher than Look Zone (20) and Buttons (50) */
            pointer-events: auto; /* Force clickable */
        }
        .slot {
            width: 50px; height: 50px; background: rgba(0,0,0,0.6); border: 2px solid #888;
            color: white; display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 9px; font-weight: bold; border-radius: 5px; cursor: pointer; text-transform: uppercase;
            pointer-events: auto; /* Double check */
        }
        .slot.active { border-color: #00ff00; background: rgba(0, 255, 0, 0.2); transform: scale(1.1); }
        .key { font-size: 14px; color: #ffff00; margin-bottom: 2px; }

        #mobile-controls { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

        #joystick-zone {
            position: absolute; bottom: 50px; left: 50px; width: 120px; height: 120px;
            background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%; touch-action: none; pointer-events: auto; 
            z-index: 50;
        }
        #joystick-knob {
            position: absolute; top: 50%; left: 50%; width: 50px; height: 50px;
            background: rgba(255, 255, 255, 0.5); border-radius: 50%;
            transform: translate(-50%, -50%); pointer-events: none;
        }

        .mob-btn {
            position: absolute; width: 60px; height: 60px;
            background: rgba(0, 0, 0, 0.5); border: 2px solid white; border-radius: 50%;
            color: white; font-weight: bold; font-size: 12px;
            display: flex; align-items: center; justify-content: center; touch-action: none; 
            pointer-events: auto; user-select: none; z-index: 50;
        }
        .mob-btn:active { background: rgba(255, 255, 255, 0.3); transform: scale(0.95); }

        #btn-jump { bottom: 180px; right: 30px; background: rgba(0,0,255,0.3); }
        #btn-shoot { bottom: 80px; right: 120px; width: 80px; height: 80px; background: rgba(255, 0, 0, 0.3); border-color: red; font-size: 16px; }
        #btn-mode { bottom: 80px; right: 30px; background: rgba(255, 165, 0, 0.3); }

        #build-select { display: none; }
        #btn-wall { bottom: 260px; right: 30px; border-color: yellow; }
        #btn-floor { bottom: 260px; right: 100px; border-color: yellow; }
        #btn-ramp { bottom: 260px; right: 170px; border-color: yellow; }

        #touch-look-zone {
            position: absolute; top: 0; right: 0; width: 50%; height: 100%;
            touch-action: none !important; 
            z-index: 20; /* Lower than Inventory (100) */
            pointer-events: auto;
            background: rgba(255,0,0,0.02);
        }

        @media (hover: none) and (pointer: coarse) {
            #mobile-controls { display: block; }
            .slot .key { display: none; } 
            #stats-container { bottom: 140px; } 
        }
    </style>
    
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
                "cannon-es": "https://unpkg.com/cannon-es@0.20.0/dist/cannon-es.js"
            }
        }
    </script>
</head>
<body>
    <div id="ui-layer">
        <div id="crosshair"></div>
        <div id="stats-container">
            <div class="bar-wrap"><div id="shield-bar"></div></div>
            <div class="bar-wrap"><div id="hp-bar"></div></div>
        </div>
        
        <div id="inventory" class="interactive">
            <div class="slot active" id="slot-1"><span class="key">1</span>Pick</div>
            <div class="slot" id="slot-2"><span class="key">2</span>Pump</div>
            <div class="slot" id="slot-3"><span class="key">3</span>AR</div>
            <div class="slot" id="slot-4"><span class="key">4</span>SMG</div>
            <div class="slot" id="slot-5"><span class="key">5</span>Snip</div>
        </div>
        
        <div id="mobile-controls">
            <div id="touch-look-zone"></div>
            <div id="joystick-zone" class="interactive"><div id="joystick-knob"></div></div>
            <div class="mob-btn interactive" id="btn-jump">JUMP</div>
            <div class="mob-btn interactive" id="btn-shoot">FIRE</div>
            <div class="mob-btn interactive" id="btn-mode">BUILD</div>
            <div id="build-select">
                <div class="mob-btn interactive" id="btn-wall">WALL</div>
                <div class="mob-btn interactive" id="btn-floor">FLOOR</div>
                <div class="mob-btn interactive" id="btn-ramp">RAMP</div>
            </div>
        </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="game.js"></script>
</body>
</html>